<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Tecnaria QA Bot</title>
  <style>
    :root{--bg:#0f172a; --panel:#111827; --panel2:#0b1220; --text:#e5e7eb; --muted:#94a3b8; --primary:#22c55e;}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#0b1328);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;color:var(--text)}
    .wrap{max-width:980px;margin:32px auto;padding:0 16px}
    .title{font-size:38px;font-weight:800;text-align:center;letter-spacing:.5px;margin:8px 0 18px}
    .chips{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;margin-bottom:18px}
    .chip{background:#0e1b33;border:1px solid #1f2a44;color:#cbd5e1;padding:8px 12px;border-radius:999px;font-size:14px;cursor:pointer}
    .card{background:linear-gradient(180deg,#0c1427,var(--panel));border:1px solid #1f2937;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.45)}
    .pad{padding:18px}
    textarea{width:100%;min-height:150px;background:var(--panel2);border:1px solid #22324a;color:var(--text);border-radius:12px;padding:14px;font-size:15px;line-height:1.5;outline:none}
    .actions{display:flex;gap:12px;align-items:center;margin-top:12px}
    .btn{background:#1a2a44;border:1px solid #284061;color:#e2e8f0;padding:10px 16px;border-radius:10px;font-weight:600;cursor:pointer}
    .btn.primary{background:var(--primary);border-color:#16a34a;color:#051511}
    .out{background:linear-gradient(180deg,#0c1427,var(--panel));border-top:1px solid #1f2937;border-radius:0 0 16px 16px;padding:16px;min-height:180px}
    .answer{max-width:860px;margin:auto;line-height:1.6}
    .answer h2{margin:0 0 8px 0}
    .answer a{color:#86efac;text-decoration:none}
    .answer a:hover{text-decoration:underline}
    .ep{font-size:12px;color:var(--muted);margin-top:10px;text-align:center}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="title">Tecnaria QA Bot</div>

    <div class="chips">
      <button class="chip" data-q="Devo usare la chiodatrice P560 per fissare i CTF. Serve un patentino o formazione speciale?">P560 + CTF</button>
      <button class="chip" data-q="Che differenza c’è tra un connettore CTF e il sistema Diapason?">CTF vs Diapason</button>
      <button class="chip" data-q="Qual è la densità di posa dei connettori CTF su lamiera Hi-Bond?">Densità CTF</button>
      <button class="chip" data-q="Come posso contattare l’assistenza Tecnaria per supporto tecnico o preventivi?">Contatti</button>
    </div>

    <div class="card">
      <div class="pad">
        <textarea id="q" placeholder="Scrivi la domanda…"></textarea>
        <div class="actions">
          <button id="ask" class="btn primary">Chiedi</button>
          <button id="clear" class="btn">Pulisci</button>
          <button id="copy" class="btn">Copia risposta</button>
        </div>
      </div>
      <div class="out">
        <div id="answer" class="answer" aria-live="polite"></div>
      </div>
    </div>

    <div class="ep">Endpoint: <code>/ask?q=…</code> (GET) oppure <code>/api/ask</code> (POST JSON)</div>
  </div>

  <script>
    const qEl = document.getElementById('q');
    const ans = document.getElementById('answer');

    document.querySelectorAll('.chip').forEach(c=>{
      c.addEventListener('click', ()=>{ qEl.value=c.getAttribute('data-q'); });
    });

    document.getElementById('ask').addEventListener('click', async ()=>{
      const q = qEl.value.trim();
      if(!q){ ans.innerHTML = "<p>Inserisci una domanda.</p>"; return; }
      ans.innerHTML = "<em>Attendere…</em>";
      try{
        const url = "/ask?" + new URLSearchParams({q});
        const html = await (await fetch(url, {method:'GET'})).text();
        ans.innerHTML = html;
      }catch(e){
        ans.textContent = "Errore di risposta";
      }
    });

    document.getElementById('clear').addEventListener('click', ()=>{
      qEl.value=""; ans.innerHTML="";
    });

    document.getElementById('copy').addEventListener('click', async ()=>{
      const tmp = ans.innerText;
      if(tmp){ await navigator.clipboard.writeText(tmp); }
    });
  </script>
</body>
</html>
